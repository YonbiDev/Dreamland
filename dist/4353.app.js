"use strict";(self.webpackChunkbabylonjs=self.webpackChunkbabylonjs||[]).push([[4353],{4353:(t,n,e)=>{e.r(n),e.d(n,{FlowGraphStopAnimationBlock:()=>r});var i=e(4720),o=e(6552),a=e(1137),s=e(1e3);class r extends s.M{constructor(t){super(t),this.animationGroup=this.registerDataInput("animationGroup",i.Vv),this.stopAtFrame=this.registerDataInput("stopAtFrame",i.Es,-1)}_preparePendingTasks(t){const n=this.animationGroup.getValue(t),e=this.stopAtFrame.getValue(t)??-1,i=t._getGlobalContextVariable("pendingStopAnimations",[]);i.push({uniqueId:n.uniqueId,stopAtFrame:e}),t._setGlobalContextVariable("pendingStopAnimations",i)}_cancelPendingTasks(t){const n=this.animationGroup.getValue(t),e=t._getGlobalContextVariable("pendingStopAnimations",[]);for(let i=0;i<e.length;i++)if(e[i].uniqueId===n.uniqueId){e.splice(i,1),t._setGlobalContextVariable("pendingStopAnimations",e);break}}_execute(t){const n=this.animationGroup.getValue(t),e=this.stopAtFrame.getValue(t)??-1;return n?isNaN(e)?this._reportError(t,"Invalid stop time."):(e>0?this._startPendingTasks(t):this._stopAnimation(n,t),void this.out._activateSignal(t)):(a.V.Warn("No animation group provided to stop."),this._reportError(t,"No animation group provided to stop."))}_executeOnTick(t){const n=this.animationGroup.getValue(t),e=t._getGlobalContextVariable("pendingStopAnimations",[]);for(let i=0;i<e.length;i++)if(e[i].uniqueId===n.uniqueId&&n.getCurrentFrame()>=e[i].stopAtFrame){this._stopAnimation(n,t),e.splice(i,1),t._setGlobalContextVariable("pendingStopAnimations",e),this.done._activateSignal(t),t._removePendingBlock(this);break}}getClassName(){return"FlowGraphStopAnimationBlock"}_stopAnimation(t,n){const e=n._getGlobalContextVariable("currentlyRunningAnimationGroups",[]),i=e.indexOf(t.uniqueId);-1!==i&&(t.stop(),e.splice(i,1),n._setGlobalContextVariable("currentlyRunningAnimationGroups",e))}}(0,o.Y5)("FlowGraphStopAnimationBlock",r)}}]);